import{_ as e,Y as a,M as t,N as l,p as o,G as s,s as u,r as m,a as r,B as d,c as n,w as i,am as f,i as c,o as p,g as _,j as y,m as h,Z as D}from"./index-DvwuWHCT.js";import{_ as V}from"./uni-easyinput.CI0qa16L.js";import{_ as b}from"./uni-forms-item.D9H7wr3d.js";import{_ as g}from"./uni-data-checkbox.CVdOplTL.js";import{_ as j}from"./uni-forms.IzwqOl-w.js";import{v as x}from"./jimoty-pay-order.BEx7_JJD.js";import"./uni-load-more.BsuNNNgF.js";const v=a.database();v.command;function k(e){let a={};for(let t in x)e.includes(t)&&(a[t]=x[t]);return a}const U=e({data(){let e={user_id:"",total_fee:null,custom:null,order_no:"",type:"",status:0,create_date:null,pay_date:null};return{formData:e,formOptions:{status_localdata:[{text:"已关闭",value:-1},{text:"未支付",value:0},{text:"已支付",value:1},{text:"已部分退款",value:2},{text:"已全额退款",value:3}]},rules:{...k(Object.keys(e))}}},onLoad(e){if(e.id){const a=e.id;this.formDataId=a,this.getDetail(a)}},onReady(){this.$refs.form.setRules(this.rules)},methods:{submit(){t({mask:!0}),this.$refs.form.validate().then((e=>this.submitForm(e))).catch((()=>{})).finally((()=>{l()}))},submitForm(e){return v.collection("jimoty-pay-order").doc(this.formDataId).update(e).then((e=>{o({title:"修改成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>s()),500)})).catch((e=>{u({content:e.message||"请求服务失败",showCancel:!1})}))},getDetail(e){t({mask:!0}),v.collection("jimoty-pay-order").doc(e).field("user_id,total_fee,custom,order_no,type,status,create_date,pay_date").get().then((e=>{const a=e.result.data[0];a&&(this.formData=a)})).catch((e=>{u({content:e.message||"请求服务失败",showCancel:!1})})).finally((()=>{l()}))}}},[["render",function(e,a,t,l,o,s){const u=m(r("uni-easyinput"),V),x=m(r("uni-forms-item"),b),v=d("undefined"),k=m(r("uni-data-checkbox"),g),U=m(r("uni-datetime-picker"),f),w=h,C=D,I=c,O=m(r("uni-forms"),j);return p(),n(I,{class:"uni-container"},{default:i((()=>[_(O,{ref:"form",model:o.formData,validateTrigger:"bind"},{default:i((()=>[_(x,{name:"user_id",label:"用户ID"},{default:i((()=>[_(u,{placeholder:"用户id，参考uni-id-users表",modelValue:o.formData.user_id,"onUpdate:modelValue":a[0]||(a[0]=e=>o.formData.user_id=e)},null,8,["modelValue"])])),_:1}),_(x,{name:"total_fee",label:"订单总金额"},{default:i((()=>[_(u,{placeholder:"订单总金额，单位为分，100等于1元",type:"number",modelValue:o.formData.total_fee,"onUpdate:modelValue":a[1]||(a[1]=e=>o.formData.total_fee=e)},null,8,["modelValue"])])),_:1}),_(x,{name:"custom",label:"自定义数据"},{default:i((()=>[_(v,{modelValue:o.formData.custom,"onUpdate:modelValue":a[2]||(a[2]=e=>o.formData.custom=e)},null,8,["modelValue"])])),_:1}),_(x,{name:"order_no",label:"业务系统订单号"},{default:i((()=>[_(u,{placeholder:"业务系统订单号，控制在20-28位（不可以是24位,24位在阿里云空间可能会有问题，可重复，代表1个业务订单会有多次付款的情况）",modelValue:o.formData.order_no,"onUpdate:modelValue":a[3]||(a[3]=e=>o.formData.order_no=e),trim:"both"},null,8,["modelValue"])])),_:1}),_(x,{name:"type",label:"订单类型"},{default:i((()=>[_(u,{placeholder:"订单类型 test：订单付款  等等，可自定义",modelValue:o.formData.type,"onUpdate:modelValue":a[4]||(a[4]=e=>o.formData.type=e),trim:"both"},null,8,["modelValue"])])),_:1}),_(x,{name:"status",label:"订单状态"},{default:i((()=>[_(k,{modelValue:o.formData.status,"onUpdate:modelValue":a[5]||(a[5]=e=>o.formData.status=e),localdata:o.formOptions.status_localdata},null,8,["modelValue","localdata"])])),_:1}),_(x,{name:"create_date",label:"创建时间"},{default:i((()=>[_(U,{"return-type":"timestamp",modelValue:o.formData.create_date,"onUpdate:modelValue":a[6]||(a[6]=e=>o.formData.create_date=e)},null,8,["modelValue"])])),_:1}),_(x,{name:"pay_date",label:"支付时间"},{default:i((()=>[_(U,{"return-type":"timestamp",modelValue:o.formData.pay_date,"onUpdate:modelValue":a[7]||(a[7]=e=>o.formData.pay_date=e)},null,8,["modelValue"])])),_:1}),_(I,{class:"uni-button-group"},{default:i((()=>[_(w,{type:"primary",class:"uni-button",style:{width:"100px"},onClick:s.submit},{default:i((()=>[y("提交")])),_:1},8,["onClick"]),_(C,{"open-type":"navigateBack",style:{"margin-left":"15px"}},{default:i((()=>[_(w,{class:"uni-button",style:{width:"100px"}},{default:i((()=>[y("返回")])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})}]]);export{U as default};
